function [partition, codebook] = design_sq(training_set, codebook, tol, maxiter)